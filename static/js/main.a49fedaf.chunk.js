(this["webpackJsonpshogi-board"]=this["webpackJsonpshogi-board"]||[]).push([[0],{10:function(e,n,t){e.exports={masu:"Masu_masu__2UQdx","sente-1":"Masu_sente-1__3nyE6","gote-1":"Masu_gote-1__BP7kL","gote-2":"Masu_gote-2__hyFud","gote-3":"Masu_gote-3__2NPey","gote-4":"Masu_gote-4__3rZwq","sente-2":"Masu_sente-2__27Gx_","sente-3":"Masu_sente-3__1zdzb","sente-4":"Masu_sente-4__1i6Rk"}},12:function(e,n,t){e.exports={mochigoma:"Mochigoma_mochigoma__1zDWF",sente:"Mochigoma_sente__1ojD5"}},20:function(e,n,t){e.exports=t(49)},25:function(e,n,t){},4:function(e,n,t){e.exports={board:"Board_board__3TDpT","nari-confirm":"Board_nari-confirm__257fG",opts:"Board_opts__1G8ez",main:"Board_main__2scwZ",table:"Board_table__3TpPN",td:"Board_td__2D2nn"}},48:function(e,n,t){},49:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),i=t(16),r=t.n(i),c=(t(25),t(3)),s=t(1),u=t.n(s),m=t(5),l=t.n(m),h=t(7),d=t(6),f=t(19),v=t(18),g=t(2),k=t(9),K={characters:["\u91d1"],movements:[[[0,-1]],[[-1,-1]],[[1,-1]],[[-1,0]],[[1,0]],[[0,1]]],nariMovements:[]},_={characters:["\u6b69","\u3068"],movements:[[[0,-1]]],nariMovements:K.movements},b={characters:["\u9999","\u674f"],movements:[u()(1,9).map((function(e){return[0,-e]}))],nariMovements:K.movements},w={characters:["\u6842","\u572d"],movements:[[[-1,-2]],[[1,-2]]],nariMovements:K.movements},O={characters:["\u9280","\u5168"],movements:[[[0,-1]],[[-1,-1]],[[1,-1]],[[-1,1]],[[1,1]]],nariMovements:K.movements},N=[u()(1,9).map((function(e){return[-e,-e]}))].concat([u()(1,9).map((function(e){return[e,-e]}))],[u()(1,9).map((function(e){return[-e,e]}))],[u()(1,9).map((function(e){return[e,e]}))]),M={characters:["\u89d2","\u99ac"],movements:N,nariMovements:N.concat([[[0,-1]]],[[[1,0]]],[[[0,1]]],[[[-1,0]]])},p=[u()(1,9).map((function(e){return[0,-e]}))].concat([u()(1,9).map((function(e){return[e,0]}))],[u()(1,9).map((function(e){return[0,e]}))],[u()(1,9).map((function(e){return[-e,0]}))]),y={characters:["\u98db","\u7adc"],movements:p,nariMovements:p.concat([[[-1,-1]]],[[[1,-1]]],[[[1,1]]],[[[-1,1]]])},S={characters:["\u7389"],movements:[[[0,-1]],[[1,-1]],[[1,0]],[[1,1]],[[0,1]],[[-1,1]],[[-1,0]],[[-1,-1]]],nariMovements:[]},C=function(){function e(n,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(d.a)(this,e),this.koma=n,this.sente=t,this.id=void 0,this.nari=void 0,this.id=e.id,this.nari=a,e.id++}return Object(k.a)(e,[{key:"getCharacter",value:function(){return 1===this.koma.characters.length?this.koma.characters[0]:this.koma.characters[this.nari?1:0]}},{key:"getMovements",value:function(){var e=this.nari?this.koma.nariMovements:this.koma.movements;return this.sente?e:e.map((function(e){return e.map((function(e){var n=Object(g.a)(e,2);return[-n[0],-n[1]]}))}))}},{key:"isSente",value:function(){return this.sente}},{key:"isGote",value:function(){return!this.isSente()}},{key:"isNari",value:function(){return this.nari}},{key:"naru",value:function(){this.nari=!0}},{key:"taken",value:function(){this.sente=!this.sente,this.nari=!1}}]),e}();C.id=0;var E,j=[[[5,9],new C(S,!0)],[[4,9],new C(K,!0)],[[6,9],new C(K,!0)],[[3,9],new C(O,!0)],[[7,9],new C(O,!0)],[[2,9],new C(w,!0)],[[8,9],new C(w,!0)],[[1,9],new C(b,!0)],[[9,9],new C(b,!0)],[[2,8],new C(y,!0)],[[8,8],new C(M,!0)],[[1,7],new C(_,!0)],[[2,7],new C(_,!0)],[[3,7],new C(_,!0)],[[4,7],new C(_,!0)],[[5,7],new C(_,!0)],[[6,7],new C(_,!0)],[[7,7],new C(_,!0)],[[8,7],new C(_,!0)],[[9,7],new C(_,!0)],[[5,1],new C(S,!1)],[[4,1],new C(K,!1)],[[6,1],new C(K,!1)],[[3,1],new C(O,!1)],[[7,1],new C(O,!1)],[[2,1],new C(w,!1)],[[8,1],new C(w,!1)],[[1,1],new C(b,!1)],[[9,1],new C(b,!1)],[[2,2],new C(M,!1)],[[8,2],new C(y,!1)],[[1,3],new C(_,!1)],[[2,3],new C(_,!1)],[[3,3],new C(_,!1)],[[4,3],new C(_,!1)],[[5,3],new C(_,!1)],[[6,3],new C(_,!1)],[[7,3],new C(_,!1)],[[8,3],new C(_,!1)],[[9,3],new C(_,!1)]],G=u()(1,10).flatMap((function(e){return u()(1,10).map((function(n){return[e,n]}))}));!function(e){e[e.OK=0]="OK",e[e.NG=1]="NG",e[e.NARI_CONFIRM=2]="NARI_CONFIRM"}(E||(E={}));var I={teme:1,holdingKoma:null,board:new(function(){function e(n,t){Object(d.a)(this,e),this.mochigomas=t,this.board=void 0,this.coordinatesByKomaId=void 0,this.board=n.reduce((function(e,n){var t=Object(g.a)(n,2),a=Object(g.a)(t[0],2),o=a[0],i=a[1],r=t[1];return e[o][i]=r,e}),u()(10).map((function(e){return u()(10).map((function(e){return null}))}))),this.coordinatesByKomaId=n.reduce((function(e,n){var t=Object(g.a)(n,2),a=t[0];return e[t[1].id]=a,e}),t.reduce((function(e,n){return e[n.id]="mochigoma",e}),{}))}return Object(k.a)(e,[{key:"getKoma",value:function(e){var n=Object(g.a)(e,2),t=n[0],a=n[1];return this.board[t][a]}},{key:"getCoordinateFor",value:function(e){return this.coordinatesByKomaId[e.id]}},{key:"moveKoma",value:function(e,n){var t=this.getCoordinateFor(e);return"mochigoma"===t?this.putMochigoma(e,n):this.canMoveTo(t,n)?(this.blindlyMoveKoma(e,t,n),this.canNaru(e,t,n)?E.NARI_CONFIRM:E.OK):E.NG}},{key:"blindlyMoveKoma",value:function(e,n,t){this.board[n[0]][n[1]]=null,this.board[t[0]][t[1]]=e,this.coordinatesByKomaId[e.id]=t}},{key:"blindlyKomaTaken",value:function(e){e.taken(),this.coordinatesByKomaId[e.id]="mochigoma",this.mochigomas.push(e)}},{key:"blindlyPutMochigoma",value:function(e,n){var t=this.mochigomas[e];this.board[n[0]][n[1]]=t,this.coordinatesByKomaId[t.id]=n,this.mochigomas.splice(e,1)}},{key:"takeKoma",value:function(e,n){var t=this.getCoordinateFor(e),a=this.getCoordinateFor(n);if("mochigoma"===a||"mochigoma"===t)return E.NG;var o=this.moveKoma(e,a);return o===E.NG?E.NG:(this.blindlyKomaTaken(n),o)}},{key:"putMochigoma",value:function(e,n){if(null!==this.getKoma(n))return E.NG;var t=this.mochigomas.findIndex((function(n){return n.id===e.id}));return t<0?E.NG:(this.blindlyPutMochigoma(t,n),E.OK)}},{key:"canNaru",value:function(e,n,t){var a=Object(g.a)(n,2),o=(a[0],a[1]),i=Object(g.a)(t,2),r=(i[0],i[1]);return!e.isNari()&&(e.isSente()&&(o<=3||r<=3)||e.isGote()&&(o>=7||r>=7))}},{key:"getSenteMochigomas",value:function(){return this.mochigomas.filter((function(e){return e.isSente()}))}},{key:"getGoteMochigomas",value:function(){return this.mochigomas.filter((function(e){return!e.isSente()}))}},{key:"canMoveTo",value:function(e,n){return null!==this.getKoma(e)&&this.calcKikiForSingleKoma(e).some((function(e){var t=Object(g.a)(e,2),a=t[0],o=t[1];return n[0]===a&&n[1]===o}))}},{key:"calcKikiForSingleKoma",value:function(e){var n,t=this,a=Object(g.a)(e,2),o=a[0],i=a[1];!function(e){e[e.OK=0]="OK",e[e.OK_AND_STOP=1]="OK_AND_STOP",e[e.NOT_OK=2]="NOT_OK"}(n||(n={}));var r=this.getKoma([o,i]);if(null===r)return[];var c=function(e,a){var o=Object(g.a)(a,2),i=o[0],r=o[1];if(!function(e){var n=Object(g.a)(e,2),t=n[0],a=n[1];return 1<=t&&t<=9&&1<=a&&a<=9}([i,r]))return n.NOT_OK;var c=t.getKoma([i,r]);return null===c?n.OK:c.isSente()===e.isSente()?n.NOT_OK:n.OK_AND_STOP};return r.getMovements().reduce((function(e,t){return t.some((function(t){var a=Object(g.a)(t,2),s=a[0],u=a[1],m=c(r,[o+s,i+u]);return m===n.NOT_OK||(e.push([o+s,i+u]),m===n.OK_AND_STOP)})),e}),[])}},{key:"calcKiki",value:function(){var e=this,n=function(){return u()(10).map((function(e){return u()(10).map((function(e){return 0}))}))};return G.reduce((function(n,t){var a=n.senteKiki,o=n.goteKiki,i=e.getKoma(t);if(null==i)return{senteKiki:a,goteKiki:o};var r=i.isSente()?a:o;return e.calcKikiForSingleKoma(t).forEach((function(e){var n=Object(g.a)(e,2),t=n[0],a=n[1];return r[t][a]++})),{senteKiki:a,goteKiki:o}}),{senteKiki:n(),goteKiki:n()})}}]),e}())(j,[]),nariConfirmShown:!1},T=function(e){Object(f.a)(t,e);var n=Object(v.a)(t);function t(){var e;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=n.call.apply(n,[this].concat(o))).state=I,e.onKomaClicked=function(n){if(!e.isNariConfirmShown()){var t=e.getHoldingKoma();null===t&&n.isSente()!==e.isSenteban()||(null!==t?t.id!==n.id?t.isSente()!==n.isSente()&&e.handleMoveKomaResult(e.state.board.takeKoma(t,n)):e.setState({holdingKoma:null}):e.setState({holdingKoma:n}))}},e.onMasuClicked=function(n){if(!e.isNariConfirmShown()&&null===e.state.board.getKoma(n)){var t=e.getHoldingKoma();null!==t&&e.handleMoveKomaResult(e.state.board.moveKoma(t,n))}},e.handleMoveKomaResult=function(n){switch(n){case E.NG:return;case E.NARI_CONFIRM:return void e.setState({board:e.state.board,nariConfirmShown:!0});case E.OK:return void e.setState({teme:e.state.teme+1,holdingKoma:null,board:e.state.board})}},e.onNariConfirmClicked=function(n){var t=e.getHoldingKoma();if(null===t)throw new Error("unexpected state");n&&t.naru(),e.setState({teme:e.state.teme+1,holdingKoma:null,nariConfirmShown:!1})},e.isSenteban=function(){return e.state.teme%2===1},e.isGoteban=function(){return!e.isSenteban()},e.isNariConfirmShown=function(){return e.state.nariConfirmShown},e.getHoldingKoma=function(){return e.state.holdingKoma},e.calcKiki=function(){return e.state.board.calcKiki()},e.getSenteMochigomas=function(){return e.state.board.getSenteMochigomas()},e.getGoteMochigomas=function(){return e.state.board.getGoteMochigomas()},e.getKoma=function(n){return e.state.board.getKoma(n)},e}return t}(c.a),B=t(8),F=t.n(B),R=function(e,n){return!!n.getHoldingKoma()||(e.isSente()&&n.isSenteban()||e.isGote()&&n.isGoteban())},A=function(e){var n=e.koma;return o.a.createElement(c.c,{to:[T]},(function(e){var t,a=e.getHoldingKoma();return o.a.createElement("div",{className:l()(F.a.koma,(t={},Object(h.a)(t,F.a.movable,R(n,e)),Object(h.a)(t,F.a.gote,n.isGote()),Object(h.a)(t,F.a.holding,a&&a.id===n.id),t)),onClick:function(){return e.onKomaClicked(n)}},n.getCharacter())}))},x=t(10),P=t.n(x),D=function(e){var n=e.koma,t=e.coordinate,a=e.senteKiki,i=e.goteKiki;return o.a.createElement(c.c,{to:[T]},(function(e){return o.a.createElement("div",{className:l()([P.a.masu,P.a["sente-".concat(Math.min(a,4))],P.a["gote-".concat(Math.min(i,4))]]),onClick:function(){e.onMasuClicked(t)}},n&&o.a.createElement(A,{koma:n}))}))},H=t(12),z=t.n(H),W=function(e){var n=e.komas;return o.a.createElement("div",{className:l()(z.a.mochigoma,Object(h.a)({},z.a.sente,n.some((function(e){return e.isSente()}))))},n.map((function(e){return o.a.createElement(A,{key:e.id,koma:e})})))},J=t(4),Z=t.n(J),q=function(){return o.a.createElement(c.b,null,o.a.createElement(c.c,{to:[T]},(function(e){var n=e.calcKiki(),t=n.senteKiki,a=n.goteKiki;return o.a.createElement("div",{className:Z.a.board},o.a.createElement("div",{className:Z.a["nari-confirm"]},e.isNariConfirmShown()&&[o.a.createElement("div",{key:"yes",className:Z.a.opts,onClick:function(){return e.onNariConfirmClicked(!0)}},"\u306f\u3044"),o.a.createElement("div",{key:"no",className:Z.a.opts,onClick:function(){return e.onNariConfirmClicked(!1)}},"\u3044\u3044\u3048")]),o.a.createElement("div",{className:Z.a.main},o.a.createElement(W,{komas:e.getGoteMochigomas()}),o.a.createElement("table",{className:Z.a.table},o.a.createElement("tbody",null,u()(1,10).map((function(n){return o.a.createElement("tr",{key:n},u()(1,10).map((function(i){return o.a.createElement("td",{key:i,className:Z.a.td},o.a.createElement(D,{koma:e.getKoma([i,n]),coordinate:[i,n],senteKiki:t[i][n],goteKiki:a[i][n]}))})))})))),o.a.createElement(W,{komas:e.getSenteMochigomas()})))})))},L=(t(48),function(){return o.a.createElement("div",{className:"App"},o.a.createElement(q,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,n,t){e.exports={koma:"Koma_koma__3c7NS",movable:"Koma_movable___ApCl",gote:"Koma_gote__jzwc7",holding:"Koma_holding__1542c"}}},[[20,1,2]]]);
//# sourceMappingURL=main.a49fedaf.chunk.js.map